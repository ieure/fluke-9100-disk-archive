Fluke 9100 Floppy Archive
=========================

This is an archive of factory media for the Fluke 9100 series of
microsystem troubleshooters.  While many disk images have been
circulating for several years, they're of unknown provenance, in
varying formats, with inconsistent quality.

The goals of this archive are to provide complete, documented,
consistent, verified images.

Organization
============

Individual disks are organized into disksets, which represent a
logical collection of disks.  Both disks and disksets are identified
with a descriptive name, version, disk number, dump number, and dump
status.

Descriptive Names
-----------------

These are usually the text printed on the disk label.

Version
-------

The version of the data contained on the disk.

Disk Number
-----------

When data is split across multiple disks, the number is indicated as
D1, D2, etc.  Optional if the disk is self-contained.

Dump Number
-----------

Dump numbers start at 01 and increment by one for each dump.  For
example, if there are two copies of the 9100A-68000-POD_USER_DISK-V1.0
disk, the first dump would be assigned 01, and the second 02.
Re-dumping the same physical disk is not encouraged, but a dump of a
second factory copy containing the same data may be desirable if the
first media is modified or damaged.

Dump Status
-----------

This consists of two letters, represeting the media and dump status.

O - Original, unmodified media.
M - Modified media.
N - Non-archival media, such as user-created disks, or
    second-generation copies.

I - Incomplete, disks missing from diskset.
G - Good dump, all sectors read successfully.
B - Bad dump, some sectors unreadable.

The status of a diskset is the same as the worst of each status of
every disk in the set.  If a diskset contains all original disks, with
one bad dump, the diskset's status is OB.  A diskset can't have a
status of OG unless every disk is original and dumped successfully.

Examples
--------

MASTER_USER_DISK-D1-V4.1__01-OG
^^^^^^^^^^^^^^^^ ^^ ^^^^  ^^ ^^
|                 |    |   | ||
|                 |    |   | | ` Good dump
|                 |    |   | |
|                 |    |   |  ` Original, unmodified media
|                 |    |   |
|                 |    |    ` First dump of this disk
|                 |    |
|                 |     ` Disk version 4.1
|                 |
|                  ` Disk 1
|
 ` Description of the data


Directory Structure
-------------------

The top level of the archive contains directories representing
disksets; underneath that is another directory for the disk(s) in the
set.

Each diskset directory contains a CATALOG file with additional
information about the dump, 600dpi scans of the disks archived, an
INDEX file with the contents of the disk, and the KryoFlux STREAM
files.

Non-Factory Dumps
-----------------

In some cases, for the sake of completeness, a disk may be included in
the archive even if it's not directly sourced from a mass-produced
original disk.  Dumps which fall into this category are put in the
NON-FACTORY directory.  This includes disks which have been modified,
disks containing user-created programs, and other things of interest.

Writing Media
=============

Disks are preserved in the Kryoflux STREAM format, which allows
perfect copies to be created.  Because these are archival images for
specialized hardware, they're larger than a typical disk image, and
cannot be used directly without Kryoflux hardware.  However, SAMDisk
supports KryoFlux STREAM images, and can be used to write the images
to disks, or to convert to a more convenient format.

To write an image to disk with SAMDisk:

SAMDISK COPY MASTER_USER_DISK-D1-V4.1,01-OG.img00.0.raw A:

To write an image to disk with Kryoflux's DTC:

dtc -fMASTER_USER_DISK-D1-V4.1,01-OG.img00.0.raw -w

To convert to ImageDisk format:

SAMDISK COPY MASTER_USER_DISK-D1-V4.1,01-OG.img00.0.raw MUD1.IMD

To convert to TeleDisk format:

SAMDISK COPY MASTER_USER_DISK-D1-V4.1,01-OG.img00.0.raw MUD1.TD0

To create a raw sector image with DiskTool Console:

DTC -l15 -fmud1.img -e79 -z1 -n+16 -k1 -i4 -m1 \
  -fMASTER_USER_DISK-D1-V4.1,01-OG -i0 -e83


Writing these images on modern hardware can present some issues, due
to the double-density drive present in 9100A mainframes.  If you're
using anything other than brand new, completely blank, unformatted
disks, the physically smaller head in a high-density drive may not be
able to completely erase the wider double density track, leading to
read errors when used on the 9100A.  These disks can be difficult to
obtain, since most new media sold from the early 1990s on was
preformatted.

If you experience issues with these disks, and you've eliminated the
floppy drive itself as the issue -- if it can read other disks, just
not the copies made from these image -- you can try one or more of
these:

1. If you're writing to HD media, make sure the density-selection hole
   is covered.
2. If you don't have success with HD media, write to DD media instead.
3. Format the disk in a double-density floppy drive, then rewrite the
   image.  You can do this on a 9100A, assuming you have one which
   boots.
3. Degauss the diskette prior to writing the image.  You'll need a
   bulk media eraser.

Installing on SCSI2SD
=====================

The SCSI2SD is a popular device which replaces SCSI disks with SD
cards.  It's compatible with the 9100, but there are some
considerations which this document attempts to capture.

Original Hardware
-----------------

The 9100A shipped with a 20mb MiniScribe 8425 MFM hard disk, which
requires an interface PCB to operate on the 9100's SCSI bus.  9100FT
machines did away with this configuration, shipping with SCSI disks
and doubling the HDR capabity to 40mb.  Both Quantum ProDrive ELS and
Conner CP-3040 disks came in the 9100FT.  There was also a field
upgrade option for the 9100A, which upgraded it to same disk
configuration as the FT.

The MiniScribe has CHS of 615/4/17, 41,820, sectors, 512 bytes/sector,
for 21,411,840 bytes of capacity.

The ProDrive ELS has CHS of 968/5/17, 82,280 sectors total, 512
bytes/sector, providing a total capacity of 42,127,360 bytes.

The Conner CP-3040 has CHS of 1026/2/40, 82,080 sectors total, 512
bytes/sector, for a total capacity of 42,024,960 bytes.

Prerequisites
-------------

You must have:

- Fluke 9100 Service Disk v1.4.  This is included in this archive as
  9100A-USAF-UPGRADE-KIT-1990__01-OG/SERVICE-V1.4__01-OG.
- SCSI2SD v5 hardware.
- A microSD card, nearly any size will do.  Even "low capacity" SD
  cards are an order of magnitude larger than the original storage
  capacity.
- Several blank 3.5" DSDD floppy disks.  The exact number will vary
  depending on system version and desired options.

If you have a 9100A, you may need to upgrade your system ROMs to v5.0.
These are included in this archive as 9100A-ROM-V5.0,01-OG.  See
CATALOG in that directory for installation instructions.


SCSI2SD Configuration
---------------------

Set your SCSI2SD up as follows:

Device 1:
Enabled
SCSI ID 0
SD card start sector 0
Sector size 512 bytes
Sector count 82280

Devices 2-4 disabled.  All other settings default.  Leave the
termination resistors installed.  Install the SD card in the SCSI2SD.

This will exactly simulate the upgraded 40mb SCSI disk.  You may
substitute the sector count of the 20mb disk if you want to simulate
it instead.

While the 9100 can handle disks up to nearly 1gb in size, this is
overkill, and EDITOR can't report more than 99,999,999 bytes of free
space.  Setting the sector count to 195,312 will produce a 99,999,744
byte disk -- larger than this is not recommended.

Installing the SCSI2SD
----------------------

Open the mainframe by removing 5 screws from the bottom of the case,
three Philips at the front, two slotted at the rear.  Flip the
mainframe over and gently lift from the sides.  The disks and power
supply are installed in the top of the case, and connected via cables
at left; be careful not to pull them.  Set the top of the case on its
side, next to the mainframe, and disconnect all cables: A square
connector to the power supply; an in-line header from the power supply
to the motherboard; floppy cable from the motherboard; SCSI cable from
the hard disk (if installed).

Flip the top of the case so it's upside-down and you can access the
disk cage.  Remove the 7 Philips screws and gently pull the cage away
from the side of the case, then up and out.  Remove the hard disk, if
installed.  Install the SCSI2SD in its place.  You will need to
acquire or fabricate a 3.5" disk bay mount for it, as it's
significantly smaller than the disk it's replacing.

Leaving the mainframe open and disk cage uninstalled, connect the
SCSI2SD to the SCSI bus and power, reconnect the floppy cable, and
reconnect the power cables.

Certain 9100FT mainframes seem to experience problems when using the
SCSI2SD v5's built-in bus termination.  If your machine hangs or
otherwise doesn't work as expected:

- Replace the SCSI cable with one having three connectors.
- Plug a terminator into the far end of the cable.
- Remove the the terminating resistor packs from the SCSI2SD.

Upgrade 9100A mainframe ROMs
----------------------------

For 9100A mainframes only; 9100FT owners can skip this section.

Use of a 40mb disk or software newer than V4.x on a 9100A requires
V5.0 ROMs to be installed.  If your mainframe has factory ROMs, the
version will be printed on a label on top.

The 9100A V5.0 ROMs are included in this archive for convenience.

The V5.0 ROMs can be programmed onto 27C512 EPROMs.  Because these are
larger than the V3.0 ROMs, you will need to change the ROM strapping
by severing the link at W2, just below the RAM slots.  Use a fresh
blade on an X-Acto or similar hobby knife to carefully open this
jumper, then verify no continuity with a multimeter.  Install the new
EPROMs and boot the machine to verify that it's working.

Setting up the Fluke
--------------------

1. Boot from the service disk by inserting it into the drive and
   powering up the mainframe. Hold down SOFT KEYS + F2 + F4 until the
   mainframe displays "Starting From Disk In /DR1."
2. Select "SET CONFIG."
3. Set the type of unit to 9100.
4. Set the hard disk type to "SCSI - 512 byte sectors."
5. Leave all other settings unchanged.  Do not turn on disk error
   reporting.
6. Select MORE, then "HARD DISK FMAT."
7. Format the hard disk.

Your mainframe is ready to install.

Installation
------------

Write disk images to media.  Depending on the system version, you will
need two or three disks for the OS, two for userdisks, and additional
disks for the programmer's option, IEEE488 support, pods, etc.

Boot from the system disk by inserting it into the drive and powering
up the mainframe. Hold down SOFT KEYS + F2 + F4 until the mainframe
displays "Starting From Disk In /DR1."

The mainframe will prompt you to insert the remaining system disks to
complete the boot process; do so.

You’ll be asked if you want to load any optional feature disks.
Select NO.  The mainframe will now boot into the OS.  Remove the last
system disk from the drive.

Select MAIN MENU, then press SOFT KEYS and select COPY.  The screen
will say "COPY DR1 TO HDR."  Insert the first system disk and press
ENTER/YES, then wait as the contents are copied over.  Repeat this for
the rest of the system disks; then the master user disks.  Finally,
copy any optional feature disks, such as the programmer system,
IEEE 488, or any pods not included on the master user disks.

When everything has been copied, restart the system to confirm that it
boots successfully.

Thanks
======

This work wouldn't be possible without help of the following people.

Andreas Kraemer
Chris Loggans
Tony Jones
Steve Larkins
